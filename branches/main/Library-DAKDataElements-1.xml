<?xml version="1.0" encoding="UTF-8"?>
<library xmlns="urn:hl7-org:elm:r1" xmlns:t="urn:hl7-org:elm-types:r1" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:fhir="http://hl7.org/fhir" xmlns:qdm43="urn:healthit-gov:qdm:v4_3" xmlns:qdm53="urn:healthit-gov:qdm:v5_3" xmlns:a="urn:hl7-org:cql-annotations:r1">
   <annotation translatorOptions="EnableAnnotations,EnableLocators,EnableResultTypes,DisableListDemotion,DisableListPromotion" xsi:type="a:CqlToElmInfo"/>
   <annotation xsi:type="a:Annotation">
      <a:s r="314">
         <a:s>library DAKDataElements version '0.1.0'</a:s>
      </a:s>
   </annotation>
   <identifier id="DAKDataElements" system="https://path-global-health.github.io/MERindicators" version="0.1.0"/>
   <schemaIdentifier id="urn:hl7-org:elm" version="r1"/>
   <usings>
      <def localIdentifier="System" uri="urn:hl7-org:elm-types:r1"/>
      <def localId="1" locator="3:1-3:26" localIdentifier="FHIR" uri="http://hl7.org/fhir" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="1">
               <a:s>using </a:s>
               <a:s>
                  <a:s>FHIR</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
   </usings>
   <includes>
      <def localId="2" locator="5:1-5:35" localIdentifier="FHIRHelpers" path="http://hl7.org/fhir/FHIRHelpers" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="2">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRHelpers</a:s>
               </a:s>
               <a:s> version '4.0.1'</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="3" locator="6:1-6:44" localIdentifier="FC" path="https://path-global-health.github.io/MERindicators/FHIRCommon" version="4.0.1">
         <annotation xsi:type="a:Annotation">
            <a:s r="3">
               <a:s>include </a:s>
               <a:s>
                  <a:s>FHIRCommon</a:s>
               </a:s>
               <a:s> version '4.0.1' called FC</a:s>
            </a:s>
         </annotation>
      </def>
      <def localId="4" locator="7:1-7:29" localIdentifier="Cx" path="https://path-global-health.github.io/MERindicators/DAKConcepts">
         <annotation xsi:type="a:Annotation">
            <a:s r="4">
               <a:s>include </a:s>
               <a:s>
                  <a:s>DAKConcepts</a:s>
               </a:s>
               <a:s> called Cx</a:s>
            </a:s>
         </annotation>
      </def>
   </includes>
   <parameters>
      <def localId="10" locator="11:1-11:94" name="Measurement Period" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="10">
               <a:s>// include DAKStratifiers called Strat

// parameter &quot;Measurement Period&quot; Interval&lt;DateTime>
parameter &quot;Measurement Period&quot; </a:s>
               <a:s r="9">
                  <a:s>Interval&lt;</a:s>
                  <a:s r="8">
                     <a:s>DateTime</a:s>
                  </a:s>
                  <a:s>></a:s>
               </a:s>
               <a:s> default </a:s>
               <a:s r="7">
                  <a:s r="5">Interval[@2022-01-01T, @2022-12-31T]</a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
            <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <default localId="7" locator="11:59-11:94" lowClosed="true" highClosed="true" xsi:type="Interval">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <low localId="5" locator="11:68-11:79" resultTypeName="t:DateTime" xsi:type="DateTime">
               <year valueType="t:Integer" value="2022" xsi:type="Literal"/>
               <month valueType="t:Integer" value="1" xsi:type="Literal"/>
               <day valueType="t:Integer" value="1" xsi:type="Literal"/>
            </low>
            <high localId="6" locator="11:82-11:93" resultTypeName="t:DateTime" xsi:type="DateTime">
               <year valueType="t:Integer" value="2022" xsi:type="Literal"/>
               <month valueType="t:Integer" value="12" xsi:type="Literal"/>
               <day valueType="t:Integer" value="31" xsi:type="Literal"/>
            </high>
         </default>
         <parameterTypeSpecifier localId="9" locator="11:32-11:49" xsi:type="IntervalTypeSpecifier">
            <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
               <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <pointType localId="8" locator="11:41-11:48" resultTypeName="t:DateTime" name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
         </parameterTypeSpecifier>
      </def>
   </parameters>
   <contexts>
      <def locator="13:1-13:15" name="Patient"/>
   </contexts>
   <statements>
      <def locator="13:1-13:15" name="Patient" context="Patient">
         <expression xsi:type="SingletonFrom">
            <operand locator="13:1-13:15" dataType="fhir:Patient" templateId="http://hl7.org/fhir/StructureDefinition/Patient" xsi:type="Retrieve"/>
         </expression>
      </def>
      <def localId="16" locator="15:1-16:32" resultTypeName="t:String" name="debug name" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="16">
               <a:s>define &quot;debug name&quot;:
  </a:s>
               <a:s r="15">
                  <a:s>First(</a:s>
                  <a:s r="14">
                     <a:s r="13">
                        <a:s r="12">
                           <a:s r="11">
                              <a:s>Patient</a:s>
                           </a:s>
                           <a:s>.</a:s>
                           <a:s r="12">
                              <a:s>name</a:s>
                           </a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="13">
                           <a:s>text</a:s>
                        </a:s>
                     </a:s>
                     <a:s>.</a:s>
                     <a:s r="14">
                        <a:s>value</a:s>
                     </a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="15" locator="16:3-16:32" resultTypeName="t:String" xsi:type="First">
            <source localId="14" locator="16:9-16:31" xsi:type="Query">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="t:String" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source alias="$this">
                  <expression localId="13" locator="16:9-16:25" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source alias="$this">
                        <expression localId="12" locator="16:9-16:20" path="name" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:HumanName" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <source localId="11" locator="16:9-16:15" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                        </expression>
                     </source>
                     <where xsi:type="Not">
                        <operand xsi:type="IsNull">
                           <operand path="text" xsi:type="Property">
                              <source name="$this" xsi:type="AliasRef"/>
                           </operand>
                        </operand>
                     </where>
                     <return distinct="false">
                        <expression path="text" xsi:type="Property">
                           <source name="$this" xsi:type="AliasRef"/>
                        </expression>
                     </return>
                  </expression>
               </source>
               <where xsi:type="Not">
                  <operand xsi:type="IsNull">
                     <operand path="value" xsi:type="Property">
                        <source name="$this" xsi:type="AliasRef"/>
                     </operand>
                  </operand>
               </where>
               <return distinct="false">
                  <expression path="value" xsi:type="Property">
                     <source name="$this" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </source>
         </expression>
      </def>
      <def localId="30" locator="18:1-20:87" resultTypeName="t:Boolean" name="Deceased" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="30">
               <a:s>define &quot;Deceased&quot;:
  </a:s>
               <a:s r="29">
                  <a:s r="19">
                     <a:s r="18">
                        <a:s r="17">
                           <a:s>Patient</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="18">
                           <a:s>deceased</a:s>
                        </a:s>
                     </a:s>
                     <a:s> is not null</a:s>
                  </a:s>
                  <a:s> 
  and </a:s>
                  <a:s r="28">
                     <a:s>(</a:s>
                     <a:s r="28">
                        <a:s r="22">
                           <a:s r="21">
                              <a:s r="20">
                                 <a:s>Patient</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="21">
                                 <a:s>deceased</a:s>
                              </a:s>
                           </a:s>
                           <a:s> is true</a:s>
                        </a:s>
                        <a:s> or </a:s>
                        <a:s r="27">
                           <a:s r="24">
                              <a:s r="23">
                                 <a:s>Patient</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="24">
                                 <a:s>deceased</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="27"> before </a:s>
                           <a:s r="26">
                              <a:s>end of </a:s>
                              <a:s r="25">
                                 <a:s>&quot;Measurement Period&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="29" locator="19:3-20:87" resultTypeName="t:Boolean" xsi:type="And">
            <operand localId="19" locator="19:3-19:30" resultTypeName="t:Boolean" xsi:type="Not">
               <operand locator="19:3-19:30" resultTypeName="t:Boolean" xsi:type="IsNull">
                  <operand localId="18" locator="19:3-19:18" path="deceased" xsi:type="Property">
                     <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                        <choice name="fhir:boolean" xsi:type="NamedTypeSpecifier"/>
                        <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="17" locator="19:3-19:9" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
            </operand>
            <operand localId="28" locator="20:7-20:87" resultTypeName="t:Boolean" xsi:type="Or">
               <operand localId="22" locator="20:8-20:31" resultTypeName="t:Boolean" xsi:type="IsTrue">
                  <operand name="ToBoolean" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand asType="fhir:boolean" xsi:type="As">
                        <operand localId="21" locator="20:8-20:23" path="deceased" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:boolean" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <source localId="20" locator="20:8-20:14" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                        </operand>
                     </operand>
                  </operand>
               </operand>
               <operand localId="27" locator="20:36-20:86" resultTypeName="t:Boolean" xsi:type="Before">
                  <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand asType="fhir:dateTime" xsi:type="As">
                        <operand localId="24" locator="20:36-20:51" path="deceased" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:boolean" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <source localId="23" locator="20:36-20:42" resultTypeName="fhir:Patient" name="Patient" xsi:type="ExpressionRef"/>
                        </operand>
                     </operand>
                  </operand>
                  <operand localId="26" locator="20:60-20:86" resultTypeName="t:DateTime" xsi:type="End">
                     <operand localId="25" locator="20:67-20:86" name="Measurement Period" xsi:type="ParameterRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </operand>
               </operand>
            </operand>
         </expression>
      </def>
      <def localId="51" locator="28:1-32:45" name="HIV Condition" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="51">
               <a:s>// and Patient.deceased.value.not()
  // and Patient.deceased.not()
  // // alternatively
  // where P.deceased is false
  //   or P.deceased before Today()
define &quot;HIV Condition&quot;:
  </a:s>
               <a:s r="50">
                  <a:s>
                     <a:s r="32">
                        <a:s r="31">
                           <a:s r="31">
                              <a:s>[Condition]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> C</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="49">
                     <a:s>where </a:s>
                     <a:s r="49">
                        <a:s r="43">
                           <a:s r="37">
                              <a:s r="34">
                                 <a:s r="33">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="34">
                                    <a:s>code</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="36">
                                 <a:s r="35">
                                    <a:s>Cx</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="36">
                                    <a:s>&quot;DAK PLHIV&quot;</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    and </a:s>
                           <a:s r="42">
                              <a:s r="39">
                                 <a:s r="38">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="39">
                                    <a:s>clinicalStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="41">
                                 <a:s r="40">
                                    <a:s>FC</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="41">
                                    <a:s>&quot;Active Condition&quot;</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
    and </a:s>
                        <a:s r="48">
                           <a:s r="45">
                              <a:s r="44">
                                 <a:s>C</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="45">
                                 <a:s>verificationStatus</a:s>
                              </a:s>
                           </a:s>
                           <a:s> ~ </a:s>
                           <a:s r="47">
                              <a:s r="46">
                                 <a:s>FC</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="47">
                                 <a:s>&quot;confirmed&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="50" locator="29:3-32:45" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="32" locator="29:3-29:15" alias="C">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="31" locator="29:3-29:13" dataType="fhir:Condition" templateId="http://hl7.org/fhir/StructureDefinition/Condition" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <where localId="49" locator="30:5-32:45" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="43" locator="30:11-31:49" resultTypeName="t:Boolean" xsi:type="And">
                  <operand localId="37" locator="30:11-30:34" resultTypeName="t:Boolean" xsi:type="InValueSet">
                     <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="34" locator="30:11-30:16" resultTypeName="fhir:CodeableConcept" path="code" scope="C" xsi:type="Property"/>
                     </code>
                     <valueset localId="36" locator="30:21-30:34" resultTypeName="t:ValueSet" name="DAK PLHIV" libraryName="Cx"/>
                  </operand>
                  <operand localId="42" locator="31:9-31:49" resultTypeName="t:Boolean" xsi:type="InValueSet">
                     <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="39" locator="31:9-31:24" resultTypeName="fhir:CodeableConcept" path="clinicalStatus" scope="C" xsi:type="Property"/>
                     </code>
                     <valueset localId="41" locator="31:29-31:49" resultTypeName="t:ValueSet" name="Active Condition" libraryName="FC"/>
                  </operand>
               </operand>
               <operand localId="48" locator="32:9-32:45" resultTypeName="t:Boolean" xsi:type="Equivalent">
                  <operand name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="45" locator="32:9-32:28" resultTypeName="fhir:CodeableConcept" path="verificationStatus" scope="C" xsi:type="Property"/>
                  </operand>
                  <operand xsi:type="ToConcept">
                     <operand localId="47" locator="32:32-32:45" resultTypeName="t:Code" name="confirmed" libraryName="FC" xsi:type="CodeRef"/>
                  </operand>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="54" locator="35:1-36:27" resultTypeName="t:Boolean" name="Is HIV Positive" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="54">
               <a:s>define &quot;Is HIV Positive&quot;:
  </a:s>
               <a:s r="53">
                  <a:s>exists</a:s>
                  <a:s r="52">
                     <a:s>( </a:s>
                     <a:s r="52">
                        <a:s>&quot;HIV Condition&quot;</a:s>
                     </a:s>
                     <a:s> )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="53" locator="36:3-36:27" resultTypeName="t:Boolean" xsi:type="Exists">
            <operand localId="52" locator="36:9-36:27" name="HIV Condition" xsi:type="ExpressionRef">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
            </operand>
         </expression>
      </def>
      <def localId="58" locator="39:1-40:31" resultTypeName="t:Boolean" name="Is HIV Negative" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="58">
               <a:s>define &quot;Is HIV Negative&quot;:
  </a:s>
               <a:s r="57">
                  <a:s>not </a:s>
                  <a:s r="56">
                     <a:s>exists</a:s>
                     <a:s r="55">
                        <a:s>( </a:s>
                        <a:s r="55">
                           <a:s>&quot;HIV Condition&quot;</a:s>
                        </a:s>
                        <a:s> )</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="57" locator="40:3-40:31" resultTypeName="t:Boolean" xsi:type="Not">
            <operand localId="56" locator="40:7-40:31" resultTypeName="t:Boolean" xsi:type="Exists">
               <operand localId="55" locator="40:13-40:31" name="HIV Condition" xsi:type="ExpressionRef">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </operand>
            </operand>
         </expression>
      </def>
      <def localId="60" locator="42:1-43:19" resultTypeName="t:Boolean" name="PLHIV" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="60">
               <a:s>define &quot;PLHIV&quot;:
  </a:s>
               <a:s r="59">
                  <a:s>&quot;Is HIV Positive&quot;</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="59" locator="43:3-43:19" resultTypeName="t:Boolean" name="Is HIV Positive" xsi:type="ExpressionRef"/>
      </def>
      <def localId="63" locator="46:1-47:48" resultTypeName="t:Boolean" name="Pregnant" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="63">
               <a:s>define &quot;Pregnant&quot;:
  </a:s>
               <a:s r="62">
                  <a:s>exists </a:s>
                  <a:s r="61">
                     <a:s>[&quot;Condition&quot;: </a:s>
                     <a:s>
                        <a:s>Cx.&quot;Pregnancy (finding)&quot;</a:s>
                     </a:s>
                     <a:s>]</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="62" locator="47:3-47:48" resultTypeName="t:Boolean" xsi:type="Exists">
            <operand localId="61" locator="47:10-47:48" dataType="fhir:Condition" templateId="http://hl7.org/fhir/StructureDefinition/Condition" codeProperty="code" codeComparator="~" xsi:type="Retrieve">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <codes xsi:type="ToList">
                  <operand locator="47:24-47:47" resultTypeName="t:Code" name="Pregnancy (finding)" libraryName="Cx" xsi:type="CodeRef"/>
               </codes>
            </operand>
         </expression>
      </def>
      <def localId="77" locator="55:1-58:28" name="ART Therapy Observation" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="77">
               <a:s>// Rest of HIVIndicators

// to review
// ART Therapy Observation=[]
// ART Therapy Condition=[]
define &quot;ART Therapy Observation&quot;:
  </a:s>
               <a:s r="76">
                  <a:s>
                     <a:s r="65">
                        <a:s r="64">
                           <a:s r="64">
                              <a:s>[Observation]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> O</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="75">
                     <a:s>where </a:s>
                     <a:s r="75">
                        <a:s r="70">
                           <a:s r="67">
                              <a:s r="66">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="67">
                                 <a:s>code</a:s>
                              </a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s r="69">
                              <a:s r="68">
                                 <a:s>Cx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="69">
                                 <a:s>&quot;DAK On ART&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="74">
                           <a:s r="72">
                              <a:s r="71">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="72">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="73">
                              <a:s>'final'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="76" locator="56:3-58:28" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="65" locator="56:3-56:17" alias="O">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="64" locator="56:3-56:15" dataType="fhir:Observation" templateId="http://hl7.org/fhir/StructureDefinition/Observation" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <where localId="75" locator="57:5-58:28" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="70" locator="57:11-57:35" resultTypeName="t:Boolean" xsi:type="InValueSet">
                  <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="67" locator="57:11-57:16" resultTypeName="fhir:CodeableConcept" path="code" scope="O" xsi:type="Property"/>
                  </code>
                  <valueset localId="69" locator="57:21-57:35" resultTypeName="t:ValueSet" name="DAK On ART" libraryName="Cx"/>
               </operand>
               <operand localId="74" locator="58:11-58:28" resultTypeName="t:Boolean" xsi:type="Equal">
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="72" locator="58:11-58:18" resultTypeName="fhir:ObservationStatus" path="status" scope="O" xsi:type="Property"/>
                  </operand>
                  <operand localId="73" locator="58:22-58:28" resultTypeName="t:String" valueType="t:String" value="final" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="98" locator="60:1-64:47" name="ART Therapy Condition" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="98">
               <a:s>define &quot;ART Therapy Condition&quot;:
  </a:s>
               <a:s r="97">
                  <a:s>
                     <a:s r="79">
                        <a:s r="78">
                           <a:s r="78">
                              <a:s>[Condition]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> C</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="96">
                     <a:s>where </a:s>
                     <a:s r="96">
                        <a:s r="90">
                           <a:s r="84">
                              <a:s r="81">
                                 <a:s r="80">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="81">
                                    <a:s>code</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="83">
                                 <a:s r="82">
                                    <a:s>Cx</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="83">
                                    <a:s>&quot;DAK On ART&quot;</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
      and </a:s>
                           <a:s r="89">
                              <a:s r="86">
                                 <a:s r="85">
                                    <a:s>C</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="86">
                                    <a:s>clinicalStatus</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> in </a:s>
                              <a:s r="88">
                                 <a:s r="87">
                                    <a:s>FC</a:s>
                                 </a:s>
                                 <a:s>.</a:s>
                                 <a:s r="88">
                                    <a:s>&quot;Active Condition&quot;</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="95">
                           <a:s r="92">
                              <a:s r="91">
                                 <a:s>C</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="92">
                                 <a:s>verificationStatus</a:s>
                              </a:s>
                           </a:s>
                           <a:s> ~ </a:s>
                           <a:s r="94">
                              <a:s r="93">
                                 <a:s>FC</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="94">
                                 <a:s>&quot;confirmed&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="97" locator="61:3-64:47" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="79" locator="61:3-61:15" alias="C">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="78" locator="61:3-61:13" dataType="fhir:Condition" templateId="http://hl7.org/fhir/StructureDefinition/Condition" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <where localId="96" locator="62:5-64:47" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="90" locator="62:11-63:51" resultTypeName="t:Boolean" xsi:type="And">
                  <operand localId="84" locator="62:11-62:35" resultTypeName="t:Boolean" xsi:type="InValueSet">
                     <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="81" locator="62:11-62:16" resultTypeName="fhir:CodeableConcept" path="code" scope="C" xsi:type="Property"/>
                     </code>
                     <valueset localId="83" locator="62:21-62:35" resultTypeName="t:ValueSet" name="DAK On ART" libraryName="Cx"/>
                  </operand>
                  <operand localId="89" locator="63:11-63:51" resultTypeName="t:Boolean" xsi:type="InValueSet">
                     <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="86" locator="63:11-63:26" resultTypeName="fhir:CodeableConcept" path="clinicalStatus" scope="C" xsi:type="Property"/>
                     </code>
                     <valueset localId="88" locator="63:31-63:51" resultTypeName="t:ValueSet" name="Active Condition" libraryName="FC"/>
                  </operand>
               </operand>
               <operand localId="95" locator="64:11-64:47" resultTypeName="t:Boolean" xsi:type="Equivalent">
                  <operand name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="92" locator="64:11-64:30" resultTypeName="fhir:CodeableConcept" path="verificationStatus" scope="C" xsi:type="Property"/>
                  </operand>
                  <operand xsi:type="ToConcept">
                     <operand localId="94" locator="64:34-64:47" resultTypeName="t:Code" name="confirmed" libraryName="FC" xsi:type="CodeRef"/>
                  </operand>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="112" locator="67:1-70:50" name="ART Therapy Medication" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="112">
               <a:s>define &quot;ART Therapy Medication&quot;:
  </a:s>
               <a:s r="111">
                  <a:s>
                     <a:s r="100">
                        <a:s r="99">
                           <a:s r="99">
                              <a:s>[&quot;MedicationRequest&quot;]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> M</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="110">
                     <a:s>where </a:s>
                     <a:s r="110">
                        <a:s r="104">
                           <a:s r="102">
                              <a:s r="101">
                                 <a:s>M</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="102">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="103">
                              <a:s>'active'</a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="109">
                           <a:s r="106">
                              <a:s r="105">
                                 <a:s>M</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="106">
                                 <a:s>medication</a:s>
                              </a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s r="108">
                              <a:s r="107">
                                 <a:s>Cx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="108">
                                 <a:s>&quot;DAK ART Medications&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="111" locator="68:3-70:50" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="100" locator="68:3-68:25" alias="M">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="99" locator="68:3-68:23" dataType="fhir:MedicationRequest" templateId="http://hl7.org/fhir/StructureDefinition/MedicationRequest" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <where localId="110" locator="69:5-70:50" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="104" locator="69:11-69:29" resultTypeName="t:Boolean" xsi:type="Equal">
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="102" locator="69:11-69:18" resultTypeName="fhir:MedicationRequestStatus" path="status" scope="M" xsi:type="Property"/>
                  </operand>
                  <operand localId="103" locator="69:22-69:29" resultTypeName="t:String" valueType="t:String" value="active" xsi:type="Literal"/>
               </operand>
               <operand localId="109" locator="70:11-70:50" resultTypeName="t:Boolean" xsi:type="InValueSet">
                  <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand asType="fhir:CodeableConcept" xsi:type="As">
                        <operand localId="106" locator="70:11-70:22" path="medication" scope="M" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Reference" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </operand>
                     </operand>
                  </code>
                  <valueset localId="108" locator="70:27-70:50" resultTypeName="t:ValueSet" name="DAK ART Medications" libraryName="Cx"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="137" locator="74:1-77:58" name="ART Dates" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="137">
               <a:s>define &quot;ART Dates&quot;:
  </a:s>
               <a:s r="136">
                  <a:s r="129">
                     <a:s r="120">
                        <a:s>(</a:s>
                        <a:s r="120">
                           <a:s>
                              <a:s r="114">
                                 <a:s r="113">
                                    <a:s>
                                       <a:s>&quot;ART Therapy Observation&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> O</a:s>
                              </a:s>
                           </a:s>
                           <a:s> </a:s>
                           <a:s r="119">
                              <a:s>return </a:s>
                              <a:s r="118">
                                 <a:s r="116">
                                    <a:s r="115">
                                       <a:s>O</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="116">
                                       <a:s>effective</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="117">
                                    <a:s>dateTime</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s>
    union </a:s>
                     <a:s r="128">
                        <a:s>(</a:s>
                        <a:s r="128">
                           <a:s>
                              <a:s r="122">
                                 <a:s r="121">
                                    <a:s>
                                       <a:s>&quot;ART Therapy Condition&quot;</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> C</a:s>
                              </a:s>
                           </a:s>
                           <a:s> </a:s>
                           <a:s r="127">
                              <a:s>return </a:s>
                              <a:s r="126">
                                 <a:s r="124">
                                    <a:s r="123">
                                       <a:s>C</a:s>
                                    </a:s>
                                    <a:s>.</a:s>
                                    <a:s r="124">
                                       <a:s>onset</a:s>
                                    </a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="125">
                                    <a:s>dateTime</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    union </a:s>
                  <a:s r="135">
                     <a:s>(</a:s>
                     <a:s r="135">
                        <a:s>
                           <a:s r="131">
                              <a:s r="130">
                                 <a:s>
                                    <a:s>&quot;ART Therapy Medication&quot;</a:s>
                                 </a:s>
                              </a:s>
                              <a:s> M</a:s>
                           </a:s>
                        </a:s>
                        <a:s> </a:s>
                        <a:s r="134">
                           <a:s>return </a:s>
                           <a:s r="133">
                              <a:s r="132">
                                 <a:s>M</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="133">
                                 <a:s>authoredOn</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                     <a:s>)</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="136" locator="75:3-77:58" xsi:type="Union">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <operand localId="129" locator="75:3-76:64" xsi:type="Union">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <operand localId="120" locator="75:3-75:62" xsi:type="Query">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source localId="114" locator="75:4-75:30" alias="O">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <expression localId="113" locator="75:4-75:28" name="ART Therapy Observation" xsi:type="ExpressionRef">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </expression>
                  </source>
                  <return localId="119" locator="75:32-75:61">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <expression localId="118" locator="75:39-75:61" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                        <operand localId="116" locator="75:39-75:49" path="effective" scope="O" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </operand>
                        <asTypeSpecifier localId="117" locator="75:54-75:61" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </expression>
                  </return>
               </operand>
               <operand localId="128" locator="76:11-76:64" xsi:type="Query">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <source localId="122" locator="76:12-76:36" alias="C">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <expression localId="121" locator="76:12-76:34" name="ART Therapy Condition" xsi:type="ExpressionRef">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </expression>
                  </source>
                  <return localId="127" locator="76:38-76:63">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <expression localId="126" locator="76:45-76:63" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                        <operand localId="124" locator="76:45-76:51" path="onset" scope="C" xsi:type="Property">
                           <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                              <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                              <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </operand>
                        <asTypeSpecifier localId="125" locator="76:56-76:63" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </expression>
                  </return>
               </operand>
            </operand>
            <operand localId="135" locator="77:11-77:58" xsi:type="Query">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source localId="131" locator="77:12-77:37" alias="M">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <expression localId="130" locator="77:12-77:35" name="ART Therapy Medication" xsi:type="ExpressionRef">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </expression>
               </source>
               <return localId="134" locator="77:39-77:57">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
                  <expression localId="133" locator="77:46-77:57" resultTypeName="fhir:dateTime" path="authoredOn" scope="M" xsi:type="Property"/>
               </return>
            </operand>
         </expression>
      </def>
      <def localId="140" locator="80:1-81:18" resultTypeName="t:DateTime" name="Date of Last Evidence of ART" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="140">
               <a:s>// union (&quot;ART Therapy Medication&quot; M return M)
define &quot;Date of Last Evidence of ART&quot;:
  </a:s>
               <a:s r="139">
                  <a:s>Max(</a:s>
                  <a:s r="138">
                     <a:s>&quot;ART Dates&quot;</a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="139" locator="81:3-81:18" resultTypeName="t:DateTime" xsi:type="Max">
            <source xsi:type="Query">
               <source alias="X">
                  <expression localId="138" locator="81:7-81:17" name="ART Dates" xsi:type="ExpressionRef">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </expression>
               </source>
               <return distinct="false">
                  <expression name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </source>
         </expression>
      </def>
      <def localId="143" locator="83:1-84:18" resultTypeName="t:DateTime" name="Date of First Evidence of ART" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="143">
               <a:s>define &quot;Date of First Evidence of ART&quot;:
  </a:s>
               <a:s r="142">
                  <a:s>Min(</a:s>
                  <a:s r="141">
                     <a:s>&quot;ART Dates&quot;</a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="142" locator="84:3-84:18" resultTypeName="t:DateTime" xsi:type="Min">
            <source xsi:type="Query">
               <source alias="X">
                  <expression localId="141" locator="84:7-84:17" name="ART Dates" xsi:type="ExpressionRef">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </expression>
               </source>
               <return distinct="false">
                  <expression name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </source>
         </expression>
      </def>
      <def localId="184" locator="138:1-141:28" name="HIV Transfer Observation" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="184">
               <a:s>define &quot;HIV Transfer Observation&quot;:
  </a:s>
               <a:s r="183">
                  <a:s>
                     <a:s r="172">
                        <a:s r="171">
                           <a:s r="171">
                              <a:s>[Observation]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> O</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="182">
                     <a:s>where </a:s>
                     <a:s r="182">
                        <a:s r="177">
                           <a:s r="174">
                              <a:s r="173">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="174">
                                 <a:s>code</a:s>
                              </a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s r="176">
                              <a:s r="175">
                                 <a:s>Cx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="176">
                                 <a:s>&quot;DAK HIV Transferred&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="181">
                           <a:s r="179">
                              <a:s r="178">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="179">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="180">
                              <a:s>'final'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="183" locator="139:3-141:28" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="172" locator="139:3-139:17" alias="O">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="171" locator="139:3-139:15" dataType="fhir:Observation" templateId="http://hl7.org/fhir/StructureDefinition/Observation" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <where localId="182" locator="140:5-141:28" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="177" locator="140:11-140:44" resultTypeName="t:Boolean" xsi:type="InValueSet">
                  <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="174" locator="140:11-140:16" resultTypeName="fhir:CodeableConcept" path="code" scope="O" xsi:type="Property"/>
                  </code>
                  <valueset localId="176" locator="140:21-140:44" resultTypeName="t:ValueSet" name="DAK HIV Transferred" libraryName="Cx"/>
               </operand>
               <operand localId="181" locator="141:11-141:28" resultTypeName="t:Boolean" xsi:type="Equal">
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="179" locator="141:11-141:18" resultTypeName="fhir:ObservationStatus" path="status" scope="O" xsi:type="Property"/>
                  </operand>
                  <operand localId="180" locator="141:22-141:28" resultTypeName="t:String" valueType="t:String" value="final" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="196" locator="146:1-147:66" resultTypeName="t:DateTime" name="Date of Last HIV Transfer" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="196">
               <a:s>define &quot;Date of Last HIV Transfer&quot;:
  </a:s>
               <a:s r="195">
                  <a:s>Max(</a:s>
                  <a:s r="194">
                     <a:s>
                        <a:s r="188">
                           <a:s r="187">
                              <a:s>
                                 <a:s>&quot;HIV Transfer Observation&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> O</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="193">
                        <a:s>return </a:s>
                        <a:s r="192">
                           <a:s r="190">
                              <a:s r="189">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="190">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="191">
                              <a:s>dateTime</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="195" locator="147:3-147:66" resultTypeName="t:DateTime" xsi:type="Max">
            <source xsi:type="Query">
               <source alias="X">
                  <expression localId="194" locator="147:7-147:65" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="188" locator="147:7-147:34" alias="O">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="187" locator="147:7-147:32" name="HIV Transfer Observation" xsi:type="ExpressionRef">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </expression>
                     </source>
                     <return localId="193" locator="147:36-147:65">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="192" locator="147:43-147:65" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                           <operand localId="190" locator="147:43-147:53" path="effective" scope="O" xsi:type="Property">
                              <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                 <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                           </operand>
                           <asTypeSpecifier localId="191" locator="147:58-147:65" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </expression>
                     </return>
                  </expression>
               </source>
               <return distinct="false">
                  <expression name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </source>
         </expression>
      </def>
      <def localId="222" locator="112:1-116:55" name="Dispensed Observations" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="222">
               <a:s>define &quot;Dispensed Observations&quot;:
  </a:s>
               <a:s r="221">
                  <a:s>
                     <a:s r="204">
                        <a:s r="203">
                           <a:s r="203">
                              <a:s>[Observation]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> O</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="214">
                     <a:s>where </a:s>
                     <a:s r="214">
                        <a:s r="209">
                           <a:s r="206">
                              <a:s r="205">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="206">
                                 <a:s>code</a:s>
                              </a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s r="208">
                              <a:s r="207">
                                 <a:s>Cx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="208">
                                 <a:s>&quot;DAK MMD&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="213">
                           <a:s r="211">
                              <a:s r="210">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="211">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="212">
                              <a:s>'final'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s> 
    </a:s>
                  <a:s r="220">
                     <a:s>sort by </a:s>
                     <a:s r="219">
                        <a:s r="218">
                           <a:s>date from </a:s>
                           <a:s r="217">
                              <a:s>(</a:s>
                              <a:s r="217">
                                 <a:s r="215">
                                    <a:s>effective</a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="216">
                                    <a:s>FHIR.dateTime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s> desc</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="221" locator="113:3-116:55" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="204" locator="113:3-113:17" alias="O">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="203" locator="113:3-113:15" dataType="fhir:Observation" templateId="http://hl7.org/fhir/StructureDefinition/Observation" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <where localId="214" locator="114:5-115:28" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="209" locator="114:11-114:32" resultTypeName="t:Boolean" xsi:type="InValueSet">
                  <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="206" locator="114:11-114:16" resultTypeName="fhir:CodeableConcept" path="code" scope="O" xsi:type="Property"/>
                  </code>
                  <valueset localId="208" locator="114:21-114:32" resultTypeName="t:ValueSet" name="DAK MMD" libraryName="Cx"/>
               </operand>
               <operand localId="213" locator="115:11-115:28" resultTypeName="t:Boolean" xsi:type="Equal">
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="211" locator="115:11-115:18" resultTypeName="fhir:ObservationStatus" path="status" scope="O" xsi:type="Property"/>
                  </operand>
                  <operand localId="212" locator="115:22-115:28" resultTypeName="t:String" valueType="t:String" value="final" xsi:type="Literal"/>
               </operand>
            </where>
            <sort localId="220" locator="116:5-116:55">
               <by localId="219" locator="116:13-116:55" resultTypeName="t:Date" direction="desc" xsi:type="ByExpression">
                  <expression localId="218" locator="116:13-116:50" resultTypeName="t:Date" xsi:type="DateFrom">
                     <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="217" locator="116:23-116:50" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                           <operand localId="215" locator="116:24-116:32" name="effective" xsi:type="IdentifierRef">
                              <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                 <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                           </operand>
                           <asTypeSpecifier localId="216" locator="116:37-116:49" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                  </expression>
               </by>
            </sort>
         </expression>
      </def>
      <def localId="225" locator="118:1-119:34" resultTypeName="fhir:Observation" name="Most Recent Dispensed Observation" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="225">
               <a:s>define &quot;Most Recent Dispensed Observation&quot;:
  </a:s>
               <a:s r="224">
                  <a:s>First( </a:s>
                  <a:s r="223">
                     <a:s>&quot;Dispensed Observations&quot;</a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="224" locator="119:3-119:34" resultTypeName="fhir:Observation" xsi:type="First">
            <source localId="223" locator="119:10-119:33" name="Dispensed Observations" xsi:type="ExpressionRef">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
            </source>
         </expression>
      </def>
      <def localId="230" locator="127:1-128:61" resultTypeName="fhir:dateTime" name="Most Recent Dispensed Observation Date" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="230">
               <a:s>define &quot;Most Recent Dispensed Observation Date&quot;:
  </a:s>
               <a:s r="229">
                  <a:s>(</a:s>
                  <a:s r="229">
                     <a:s r="227">
                        <a:s r="226">
                           <a:s>&quot;Most Recent Dispensed Observation&quot;</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="227">
                           <a:s>effective</a:s>
                        </a:s>
                     </a:s>
                     <a:s> as </a:s>
                     <a:s r="228">
                        <a:s>dateTime</a:s>
                     </a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="229" locator="128:3-128:61" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
            <operand localId="227" locator="128:4-128:48" path="effective" xsi:type="Property">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source localId="226" locator="128:4-128:38" resultTypeName="fhir:Observation" name="Most Recent Dispensed Observation" xsi:type="ExpressionRef"/>
            </operand>
            <asTypeSpecifier localId="228" locator="128:53-128:60" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
         </expression>
      </def>
      <def localId="236" locator="121:1-122:56" resultTypeName="fhir:integer" name="Most Recent Dispensed Observation Days" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="236">
               <a:s>define &quot;Most Recent Dispensed Observation Days&quot;:
  </a:s>
               <a:s r="235">
                  <a:s>(</a:s>
                  <a:s r="235">
                     <a:s r="233">
                        <a:s r="232">
                           <a:s>&quot;Most Recent Dispensed Observation&quot;</a:s>
                        </a:s>
                        <a:s>.</a:s>
                        <a:s r="233">
                           <a:s>value</a:s>
                        </a:s>
                     </a:s>
                     <a:s> as </a:s>
                     <a:s r="234">
                        <a:s>integer</a:s>
                     </a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="235" locator="122:3-122:56" resultTypeName="fhir:integer" strict="false" xsi:type="As">
            <operand localId="233" locator="122:4-122:44" path="value" xsi:type="Property">
               <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                  <choice name="fhir:Quantity" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:CodeableConcept" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:boolean" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:integer" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Ratio" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:SampledData" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:time" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                  <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <source localId="232" locator="122:4-122:38" resultTypeName="fhir:Observation" name="Most Recent Dispensed Observation" xsi:type="ExpressionRef"/>
            </operand>
            <asTypeSpecifier localId="234" locator="122:49-122:55" resultTypeName="fhir:integer" name="fhir:integer" xsi:type="NamedTypeSpecifier"/>
         </expression>
      </def>
      <def localId="242" locator="124:1-125:74" resultTypeName="t:Quantity" name="Dispensed in Days" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="242">
               <a:s>define &quot;Dispensed in Days&quot;:
  </a:s>
               <a:s r="241">
                  <a:s>ToQuantity(</a:s>
                  <a:s r="240">
                     <a:s r="238">
                        <a:s>ToString(</a:s>
                        <a:s r="237">
                           <a:s>&quot;Most Recent Dispensed Observation Days&quot;</a:s>
                        </a:s>
                        <a:s>)</a:s>
                     </a:s>
                     <a:s> + </a:s>
                     <a:s r="239">
                        <a:s>' days'</a:s>
                     </a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="241" locator="125:3-125:74" resultTypeName="t:Quantity" xsi:type="ToQuantity">
            <operand localId="240" locator="125:14-125:73" resultTypeName="t:String" xsi:type="Concatenate">
               <operand localId="238" locator="125:14-125:63" resultTypeName="t:String" xsi:type="ToString">
                  <operand name="ToInteger" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="237" locator="125:23-125:62" resultTypeName="fhir:integer" name="Most Recent Dispensed Observation Days" xsi:type="ExpressionRef"/>
                  </operand>
               </operand>
               <operand localId="239" locator="125:67-125:73" resultTypeName="t:String" valueType="t:String" value=" days" xsi:type="Literal"/>
            </operand>
         </expression>
      </def>
      <def localId="245" locator="130:1-131:64" resultTypeName="t:DateTime" name="Most Recent Dispensed Observation Finish Date" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="245">
               <a:s>define &quot;Most Recent Dispensed Observation Finish Date&quot;:
  </a:s>
               <a:s r="244">
                  <a:s r="231">
                     <a:s>&quot;Most Recent Dispensed Observation Date&quot;</a:s>
                  </a:s>
                  <a:s> + </a:s>
                  <a:s r="243">
                     <a:s>&quot;Dispensed in Days&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="244" locator="131:3-131:64" resultTypeName="t:DateTime" xsi:type="Add">
            <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
               <operand localId="231" locator="131:3-131:42" resultTypeName="fhir:dateTime" name="Most Recent Dispensed Observation Date" xsi:type="ExpressionRef"/>
            </operand>
            <operand localId="243" locator="131:46-131:64" resultTypeName="t:Quantity" name="Dispensed in Days" xsi:type="ExpressionRef"/>
         </expression>
      </def>
      <def localId="250" locator="87:1-104:3" resultTypeName="t:Boolean" name="On ART" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="250">
               <a:s>define &quot;On ART&quot;:
  </a:s>
               <a:s r="249">
                  <a:s r="202">
                     <a:s r="170">
                        <a:s>( 
    </a:s>
                        <a:s r="170">
                           <a:s>( </a:s>
                           <a:s r="170">
                              <a:s r="150">
                                 <a:s>exists </a:s>
                                 <a:s r="149">
                                    <a:s>(</a:s>
                                    <a:s r="149">
                                       <a:s>
                                          <a:s r="145">
                                             <a:s r="144">
                                                <a:s>
                                                   <a:s>&quot;ART Dates&quot;</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> D</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s> </a:s>
                                       <a:s r="148">
                                          <a:s>where </a:s>
                                          <a:s r="148">
                                             <a:s r="146">
                                                <a:s>D</a:s>
                                             </a:s>
                                             <a:s r="148"> during </a:s>
                                             <a:s r="147">
                                                <a:s>&quot;Measurement Period&quot;</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>)</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>
      or </a:s>
                              <a:s r="169">
                                 <a:s>exists </a:s>
                                 <a:s r="168">
                                    <a:s>(
        </a:s>
                                    <a:s r="168">
                                       <a:s>
                                          <a:s r="152">
                                             <a:s r="151">
                                                <a:s>
                                                   <a:s>&quot;ART Therapy Condition&quot;</a:s>
                                                </a:s>
                                             </a:s>
                                             <a:s> C</a:s>
                                          </a:s>
                                       </a:s>
                                       <a:s>
          </a:s>
                                       <a:s r="167">
                                          <a:s>where </a:s>
                                          <a:s r="167">
                                             <a:s r="165">
                                                <a:s>Interval[</a:s>
                                                <a:s r="158">
                                                   <a:s r="153">
                                                      <a:s>FHIRHelpers</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="158">
                                                      <a:s>ToDateTime(</a:s>
                                                      <a:s r="157">
                                                         <a:s r="155">
                                                            <a:s r="154">
                                                               <a:s>C</a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s r="155">
                                                               <a:s>onset</a:s>
                                                            </a:s>
                                                         </a:s>
                                                         <a:s> as </a:s>
                                                         <a:s r="156">
                                                            <a:s>FHIR.dateTime</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s>)</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>, </a:s>
                                                <a:s r="164">
                                                   <a:s r="159">
                                                      <a:s>FHIRHelpers</a:s>
                                                   </a:s>
                                                   <a:s>.</a:s>
                                                   <a:s r="164">
                                                      <a:s>ToDateTime(</a:s>
                                                      <a:s r="163">
                                                         <a:s r="161">
                                                            <a:s r="160">
                                                               <a:s>C</a:s>
                                                            </a:s>
                                                            <a:s>.</a:s>
                                                            <a:s r="161">
                                                               <a:s>abatement</a:s>
                                                            </a:s>
                                                         </a:s>
                                                         <a:s> as </a:s>
                                                         <a:s r="162">
                                                            <a:s>FHIR.dateTime</a:s>
                                                         </a:s>
                                                      </a:s>
                                                      <a:s>)</a:s>
                                                   </a:s>
                                                </a:s>
                                                <a:s>]</a:s>
                                             </a:s>
                                             <a:s r="167"> overlaps </a:s>
                                             <a:s r="166">
                                                <a:s>&quot;Measurement Period&quot;</a:s>
                                             </a:s>
                                          </a:s>
                                       </a:s>
                                    </a:s>
                                    <a:s>
      )</a:s>
                                 </a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    )</a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                     <a:s>
  or 
  </a:s>
                     <a:s r="201">
                        <a:s>( </a:s>
                        <a:s r="201">
                           <a:s>if </a:s>
                           <a:s r="186">
                              <a:s>exists</a:s>
                              <a:s r="185">
                                 <a:s>( </a:s>
                                 <a:s r="185">
                                    <a:s>&quot;HIV Transfer Observation&quot;</a:s>
                                 </a:s>
                                 <a:s> )</a:s>
                              </a:s>
                           </a:s>
                           <a:s>
    then </a:s>
                           <a:s r="199">
                              <a:s r="197">
                                 <a:s>&quot;Date of Last HIV Transfer&quot;</a:s>
                              </a:s>
                              <a:s r="199"> during </a:s>
                              <a:s r="198">
                                 <a:s>&quot;Measurement Period&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s r="200">
    else false</a:s>
                        </a:s>
                        <a:s>
  )</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
  or
  </a:s>
                  <a:s r="248">
                     <a:s>(
    </a:s>
                     <a:s r="248">
                        <a:s r="246">
                           <a:s>&quot;Most Recent Dispensed Observation Finish Date&quot;</a:s>
                        </a:s>
                        <a:s r="248"> after </a:s>
                        <a:s r="247">
                           <a:s>&quot;Measurement Period&quot;</a:s>
                        </a:s>
                     </a:s>
                     <a:s>
  )</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="249" locator="88:3-104:3" resultTypeName="t:Boolean" xsi:type="Or">
            <operand localId="202" locator="88:3-100:3" resultTypeName="t:Boolean" xsi:type="Or">
               <operand localId="170" locator="88:3-95:3" resultTypeName="t:Boolean" xsi:type="Or">
                  <operand localId="150" locator="89:7-89:64" resultTypeName="t:Boolean" xsi:type="Exists">
                     <operand localId="149" locator="89:14-89:64" xsi:type="Query">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="145" locator="89:15-89:27" alias="D">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <expression localId="144" locator="89:15-89:25" name="ART Dates" xsi:type="ExpressionRef">
                              <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                 <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                           </expression>
                        </source>
                        <where localId="148" locator="89:29-89:63" resultTypeName="t:Boolean" xsi:type="In">
                           <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                              <operand localId="146" locator="89:35" resultTypeName="fhir:dateTime" name="D" xsi:type="AliasRef"/>
                           </operand>
                           <operand localId="147" locator="89:44-89:63" name="Measurement Period" xsi:type="ParameterRef">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                           </operand>
                        </where>
                     </operand>
                  </operand>
                  <operand localId="169" locator="90:10-93:7" resultTypeName="t:Boolean" xsi:type="Exists">
                     <operand localId="168" locator="90:17-93:7" xsi:type="Query">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <source localId="152" locator="91:9-91:33" alias="C">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                           <expression localId="151" locator="91:9-91:31" name="ART Therapy Condition" xsi:type="ExpressionRef">
                              <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                                 <elementType name="fhir:Condition" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                           </expression>
                        </source>
                        <where localId="167" locator="92:11-92:158" resultTypeName="t:Boolean" xsi:type="Overlaps">
                           <operand localId="165" locator="92:17-92:128" lowClosed="true" highClosed="true" xsi:type="Interval">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                              <low localId="158" locator="92:26-92:73" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="157" locator="92:49-92:72" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                                    <operand localId="155" locator="92:49-92:55" path="onset" scope="C" xsi:type="Property">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="156" locator="92:60-92:72" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 </operand>
                              </low>
                              <high localId="164" locator="92:76-92:127" resultTypeName="t:DateTime" name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                                 <operand localId="163" locator="92:99-92:126" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                                    <operand localId="161" locator="92:99-92:109" path="abatement" scope="C" xsi:type="Property">
                                       <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                          <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Age" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:Range" xsi:type="NamedTypeSpecifier"/>
                                          <choice name="fhir:string" xsi:type="NamedTypeSpecifier"/>
                                       </resultTypeSpecifier>
                                    </operand>
                                    <asTypeSpecifier localId="162" locator="92:114-92:126" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 </operand>
                              </high>
                           </operand>
                           <operand localId="166" locator="92:139-92:158" name="Measurement Period" xsi:type="ParameterRef">
                              <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                                 <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                           </operand>
                        </where>
                     </operand>
                  </operand>
               </operand>
               <operand localId="201" locator="97:3-100:3" resultTypeName="t:Boolean" xsi:type="If">
                  <condition localId="186" locator="97:8-97:43" resultTypeName="t:Boolean" xsi:type="Exists">
                     <operand localId="185" locator="97:14-97:43" name="HIV Transfer Observation" xsi:type="ExpressionRef">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </condition>
                  <then localId="199" locator="98:10-98:64" resultTypeName="t:Boolean" xsi:type="In">
                     <operand localId="197" locator="98:10-98:36" resultTypeName="t:DateTime" name="Date of Last HIV Transfer" xsi:type="ExpressionRef"/>
                     <operand localId="198" locator="98:45-98:64" name="Measurement Period" xsi:type="ParameterRef">
                        <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                           <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                     </operand>
                  </then>
                  <else localId="200" locator="99:10-99:14" resultTypeName="t:Boolean" valueType="t:Boolean" value="false" xsi:type="Literal"/>
               </operand>
            </operand>
            <operand localId="248" locator="102:3-104:3" resultTypeName="t:Boolean" xsi:type="After">
               <operand xsi:type="If">
                  <condition xsi:type="IsNull">
                     <operand localId="246" locator="103:5-103:51" resultTypeName="t:DateTime" name="Most Recent Dispensed Observation Finish Date" xsi:type="ExpressionRef"/>
                  </condition>
                  <then xsi:type="Null">
                     <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                        <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                  </then>
                  <else lowClosed="true" highClosed="true" xsi:type="Interval">
                     <low localId="246" locator="103:5-103:51" resultTypeName="t:DateTime" name="Most Recent Dispensed Observation Finish Date" xsi:type="ExpressionRef"/>
                     <high localId="246" locator="103:5-103:51" resultTypeName="t:DateTime" name="Most Recent Dispensed Observation Finish Date" xsi:type="ExpressionRef"/>
                  </else>
               </operand>
               <operand localId="247" locator="103:59-103:78" name="Measurement Period" xsi:type="ParameterRef">
                  <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                     <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </operand>
            </operand>
         </expression>
      </def>
      <def localId="264" locator="133:1-136:28" name="Stopped ART Observation" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="264">
               <a:s>define &quot;Stopped ART Observation&quot;:
  </a:s>
               <a:s r="263">
                  <a:s>
                     <a:s r="252">
                        <a:s r="251">
                           <a:s r="251">
                              <a:s>[Observation]</a:s>
                           </a:s>
                        </a:s>
                        <a:s> O</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="262">
                     <a:s>where </a:s>
                     <a:s r="262">
                        <a:s r="257">
                           <a:s r="254">
                              <a:s r="253">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="254">
                                 <a:s>code</a:s>
                              </a:s>
                           </a:s>
                           <a:s> in </a:s>
                           <a:s r="256">
                              <a:s r="255">
                                 <a:s>Cx</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="256">
                                 <a:s>&quot;DAK ART Stopped&quot;</a:s>
                              </a:s>
                           </a:s>
                        </a:s>
                        <a:s>
      and </a:s>
                        <a:s r="261">
                           <a:s r="259">
                              <a:s r="258">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="259">
                                 <a:s>status</a:s>
                              </a:s>
                           </a:s>
                           <a:s> = </a:s>
                           <a:s r="260">
                              <a:s>'final'</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="263" locator="134:3-136:28" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="252" locator="134:3-134:17" alias="O">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="251" locator="134:3-134:15" dataType="fhir:Observation" templateId="http://hl7.org/fhir/StructureDefinition/Observation" xsi:type="Retrieve">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <where localId="262" locator="135:5-136:28" resultTypeName="t:Boolean" xsi:type="And">
               <operand localId="257" locator="135:11-135:40" resultTypeName="t:Boolean" xsi:type="InValueSet">
                  <code name="ToConcept" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="254" locator="135:11-135:16" resultTypeName="fhir:CodeableConcept" path="code" scope="O" xsi:type="Property"/>
                  </code>
                  <valueset localId="256" locator="135:21-135:40" resultTypeName="t:ValueSet" name="DAK ART Stopped" libraryName="Cx"/>
               </operand>
               <operand localId="261" locator="136:11-136:28" resultTypeName="t:Boolean" xsi:type="Equal">
                  <operand name="ToString" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand localId="259" locator="136:11-136:18" resultTypeName="fhir:ObservationStatus" path="status" scope="O" xsi:type="Property"/>
                  </operand>
                  <operand localId="260" locator="136:22-136:28" resultTypeName="t:String" valueType="t:String" value="final" xsi:type="Literal"/>
               </operand>
            </where>
         </expression>
      </def>
      <def localId="276" locator="143:1-144:65" resultTypeName="t:DateTime" name="Date of Last Stopped ART" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="276">
               <a:s>define &quot;Date of Last Stopped ART&quot;:
  </a:s>
               <a:s r="275">
                  <a:s>Max(</a:s>
                  <a:s r="274">
                     <a:s>
                        <a:s r="268">
                           <a:s r="267">
                              <a:s>
                                 <a:s>&quot;Stopped ART Observation&quot;</a:s>
                              </a:s>
                           </a:s>
                           <a:s> O</a:s>
                        </a:s>
                     </a:s>
                     <a:s> </a:s>
                     <a:s r="273">
                        <a:s>return </a:s>
                        <a:s r="272">
                           <a:s r="270">
                              <a:s r="269">
                                 <a:s>O</a:s>
                              </a:s>
                              <a:s>.</a:s>
                              <a:s r="270">
                                 <a:s>effective</a:s>
                              </a:s>
                           </a:s>
                           <a:s> as </a:s>
                           <a:s r="271">
                              <a:s>dateTime</a:s>
                           </a:s>
                        </a:s>
                     </a:s>
                  </a:s>
                  <a:s>)</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="275" locator="144:3-144:65" resultTypeName="t:DateTime" xsi:type="Max">
            <source xsi:type="Query">
               <source alias="X">
                  <expression localId="274" locator="144:7-144:64" xsi:type="Query">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <source localId="268" locator="144:7-144:33" alias="O">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="267" locator="144:7-144:31" name="Stopped ART Observation" xsi:type="ExpressionRef">
                           <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                              <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                           </resultTypeSpecifier>
                        </expression>
                     </source>
                     <return localId="273" locator="144:35-144:64">
                        <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                           <elementType name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </resultTypeSpecifier>
                        <expression localId="272" locator="144:42-144:64" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                           <operand localId="270" locator="144:42-144:52" path="effective" scope="O" xsi:type="Property">
                              <resultTypeSpecifier xsi:type="ChoiceTypeSpecifier">
                                 <choice name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Period" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:Timing" xsi:type="NamedTypeSpecifier"/>
                                 <choice name="fhir:instant" xsi:type="NamedTypeSpecifier"/>
                              </resultTypeSpecifier>
                           </operand>
                           <asTypeSpecifier localId="271" locator="144:57-144:64" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </expression>
                     </return>
                  </expression>
               </source>
               <return distinct="false">
                  <expression name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                     <operand name="X" xsi:type="AliasRef"/>
                  </expression>
               </return>
            </source>
         </expression>
      </def>
      <def localId="286" locator="106:1-110:12" resultTypeName="t:Boolean" name="Stopped ART" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="286">
               <a:s>define &quot;Stopped ART&quot;:
  </a:s>
               <a:s r="285">
                  <a:s>if </a:s>
                  <a:s r="266">
                     <a:s>exists</a:s>
                     <a:s r="265">
                        <a:s>( </a:s>
                        <a:s r="265">
                           <a:s>&quot;Stopped ART Observation&quot;</a:s>
                        </a:s>
                        <a:s> )</a:s>
                     </a:s>
                  </a:s>
                  <a:s> 
  then </a:s>
                  <a:s r="283">
                     <a:s r="277">
                        <a:s>&quot;Date of Last Stopped ART&quot;</a:s>
                     </a:s>
                     <a:s r="283"> after 
    </a:s>
                     <a:s r="282">
                        <a:s>Max( </a:s>
                        <a:s r="281">
                           <a:s>{ </a:s>
                           <a:s r="278">
                              <a:s>&quot;Date of Last Evidence of ART&quot;</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="279">
                              <a:s>&quot;Date of Last HIV Transfer&quot;</a:s>
                           </a:s>
                           <a:s>, </a:s>
                           <a:s r="280">
                              <a:s>&quot;Most Recent Dispensed Observation Finish Date&quot;</a:s>
                           </a:s>
                           <a:s> }</a:s>
                        </a:s>
                        <a:s> )</a:s>
                     </a:s>
                  </a:s>
                  <a:s r="284">
  else false</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="285" locator="107:3-110:12" resultTypeName="t:Boolean" xsi:type="If">
            <condition localId="266" locator="107:6-107:40" resultTypeName="t:Boolean" xsi:type="Exists">
               <operand localId="265" locator="107:12-107:40" name="Stopped ART Observation" xsi:type="ExpressionRef">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:Observation" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </operand>
            </condition>
            <then localId="283" locator="108:8-109:123" resultTypeName="t:Boolean" xsi:type="After">
               <operand localId="277" locator="108:8-108:33" resultTypeName="t:DateTime" name="Date of Last Stopped ART" xsi:type="ExpressionRef"/>
               <operand localId="282" locator="109:5-109:123" resultTypeName="t:DateTime" xsi:type="Max">
                  <source localId="281" locator="109:10-109:121" xsi:type="List">
                     <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                        <elementType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
                     </resultTypeSpecifier>
                     <element localId="278" locator="109:12-109:41" resultTypeName="t:DateTime" name="Date of Last Evidence of ART" xsi:type="ExpressionRef"/>
                     <element localId="279" locator="109:44-109:70" resultTypeName="t:DateTime" name="Date of Last HIV Transfer" xsi:type="ExpressionRef"/>
                     <element localId="280" locator="109:73-109:119" resultTypeName="t:DateTime" name="Most Recent Dispensed Observation Finish Date" xsi:type="ExpressionRef"/>
                  </source>
               </operand>
            </then>
            <else localId="284" locator="110:8-110:12" resultTypeName="t:Boolean" valueType="t:Boolean" value="false" xsi:type="Literal"/>
         </expression>
      </def>
      <def localId="290" locator="149:1-150:61" resultTypeName="t:Boolean" name="Newly enrolled on antiretroviral therapy (ART) during measurement period" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="290">
               <a:s>define &quot;Newly enrolled on antiretroviral therapy (ART) during measurement period&quot;:
  </a:s>
               <a:s r="289">
                  <a:s r="287">
                     <a:s>&quot;Date of First Evidence of ART&quot;</a:s>
                  </a:s>
                  <a:s r="289"> during </a:s>
                  <a:s r="288">
                     <a:s>&quot;Measurement Period&quot;</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="289" locator="150:3-150:61" resultTypeName="t:Boolean" xsi:type="In">
            <operand localId="287" locator="150:3-150:33" resultTypeName="t:DateTime" name="Date of First Evidence of ART" xsi:type="ExpressionRef"/>
            <operand localId="288" locator="150:42-150:61" name="Measurement Period" xsi:type="ParameterRef">
               <resultTypeSpecifier xsi:type="IntervalTypeSpecifier">
                  <pointType name="t:DateTime" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
            </operand>
         </expression>
      </def>
      <def localId="300" locator="152:1-154:56" name="Requested ARTs" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="300">
               <a:s>define &quot;Requested ARTs&quot;:
  </a:s>
               <a:s r="299">
                  <a:s>
                     <a:s r="292">
                        <a:s r="291">
                           <a:s>
                              <a:s>&quot;ART Therapy Medication&quot;</a:s>
                           </a:s>
                        </a:s>
                        <a:s> M</a:s>
                     </a:s>
                  </a:s>
                  <a:s>
    </a:s>
                  <a:s r="298">
                     <a:s>sort by </a:s>
                     <a:s r="297">
                        <a:s r="296">
                           <a:s>date from </a:s>
                           <a:s r="295">
                              <a:s>(</a:s>
                              <a:s r="295">
                                 <a:s r="293">
                                    <a:s>authoredOn</a:s>
                                 </a:s>
                                 <a:s> as </a:s>
                                 <a:s r="294">
                                    <a:s>FHIR.dateTime</a:s>
                                 </a:s>
                              </a:s>
                              <a:s>)</a:s>
                           </a:s>
                        </a:s>
                        <a:s> desc</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <resultTypeSpecifier xsi:type="ListTypeSpecifier">
            <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
         </resultTypeSpecifier>
         <expression localId="299" locator="153:3-154:56" xsi:type="Query">
            <resultTypeSpecifier xsi:type="ListTypeSpecifier">
               <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
            </resultTypeSpecifier>
            <source localId="292" locator="153:3-153:28" alias="M">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
               <expression localId="291" locator="153:3-153:26" name="ART Therapy Medication" xsi:type="ExpressionRef">
                  <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                     <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
                  </resultTypeSpecifier>
               </expression>
            </source>
            <sort localId="298" locator="154:5-154:56">
               <by localId="297" locator="154:13-154:56" resultTypeName="t:Date" direction="desc" xsi:type="ByExpression">
                  <expression localId="296" locator="154:13-154:51" resultTypeName="t:Date" xsi:type="DateFrom">
                     <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
                        <operand localId="295" locator="154:23-154:51" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
                           <operand localId="293" locator="154:24-154:33" resultTypeName="fhir:dateTime" name="authoredOn" xsi:type="IdentifierRef"/>
                           <asTypeSpecifier localId="294" locator="154:38-154:50" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
                        </operand>
                     </operand>
                  </expression>
               </by>
            </sort>
         </expression>
      </def>
      <def localId="303" locator="156:1-157:27" resultTypeName="fhir:MedicationRequest" name="Most Recent Requested ART" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="303">
               <a:s>define &quot;Most Recent Requested ART&quot;:
  </a:s>
               <a:s r="302">
                  <a:s>First( </a:s>
                  <a:s r="301">
                     <a:s>&quot;Requested ARTs&quot;</a:s>
                  </a:s>
                  <a:s> )</a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="302" locator="157:3-157:27" resultTypeName="fhir:MedicationRequest" xsi:type="First">
            <source localId="301" locator="157:10-157:25" name="Requested ARTs" xsi:type="ExpressionRef">
               <resultTypeSpecifier xsi:type="ListTypeSpecifier">
                  <elementType name="fhir:MedicationRequest" xsi:type="NamedTypeSpecifier"/>
               </resultTypeSpecifier>
            </source>
         </expression>
      </def>
      <def localId="308" locator="159:1-160:52" resultTypeName="fhir:dateTime" name="Most Recent Requested ART Date" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="308">
               <a:s>define &quot;Most Recent Requested ART Date&quot;:
  </a:s>
               <a:s r="307">
                  <a:s r="305">
                     <a:s r="304">
                        <a:s>&quot;Most Recent Requested ART&quot;</a:s>
                     </a:s>
                     <a:s>.</a:s>
                     <a:s r="305">
                        <a:s>authoredOn</a:s>
                     </a:s>
                  </a:s>
                  <a:s> as </a:s>
                  <a:s r="306">
                     <a:s>dateTime</a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="307" locator="160:3-160:52" resultTypeName="fhir:dateTime" strict="false" xsi:type="As">
            <operand localId="305" locator="160:3-160:40" resultTypeName="fhir:dateTime" path="authoredOn" xsi:type="Property">
               <source localId="304" locator="160:3-160:29" resultTypeName="fhir:MedicationRequest" name="Most Recent Requested ART" xsi:type="ExpressionRef"/>
            </operand>
            <asTypeSpecifier localId="306" locator="160:45-160:52" resultTypeName="fhir:dateTime" name="fhir:dateTime" xsi:type="NamedTypeSpecifier"/>
         </expression>
      </def>
      <def localId="314" locator="163:1-164:56" resultTypeName="t:Boolean" name="Patient with IIT" context="Patient" accessLevel="Public">
         <annotation xsi:type="a:Annotation">
            <a:s r="314">
               <a:s>define &quot;Patient with IIT&quot;:
  </a:s>
               <a:s r="313">
                  <a:s r="309">
                     <a:s>&quot;Most Recent Requested ART Date&quot;</a:s>
                  </a:s>
                  <a:s r="313"> after </a:s>
                  <a:s r="312">
                     <a:s r="310">
                        <a:s>now()</a:s>
                     </a:s>
                     <a:s> + </a:s>
                     <a:s r="311">
                        <a:s>28 days</a:s>
                     </a:s>
                  </a:s>
               </a:s>
            </a:s>
         </annotation>
         <expression localId="313" locator="164:3-164:56" resultTypeName="t:Boolean" xsi:type="After">
            <operand name="ToDateTime" libraryName="FHIRHelpers" xsi:type="FunctionRef">
               <operand localId="309" locator="164:3-164:34" resultTypeName="fhir:dateTime" name="Most Recent Requested ART Date" xsi:type="ExpressionRef"/>
            </operand>
            <operand localId="312" locator="164:42-164:56" resultTypeName="t:DateTime" xsi:type="Add">
               <operand localId="310" locator="164:42-164:46" resultTypeName="t:DateTime" xsi:type="Now"/>
               <operand localId="311" locator="164:50-164:56" resultTypeName="t:Quantity" value="28" unit="days" xsi:type="Quantity"/>
            </operand>
         </expression>
      </def>
   </statements>
</library>
